---
classes:
  - "profile::archive::common"
  - "profile::archive::data::comcam"
profile::archive::rabbitmq::vhosts:
  "/test_at":
    ensure: "present"
  "/test_cc":
    ensure: "present"
profile::archive::rabbitmq::user_permissions:
  "iip@/test_cc":
    configure_permission: ".*"
    read_permission: ".*"
    write_permission: ".*"
  "guest@/test_cc":
    configure_permission: ".*"
    read_permission: ".*"
    write_permission: ".*"
  "iip@/test_at":
    configure_permission: ".*"
    read_permission: ".*"
    write_permission: ".*"
  "guest@/test_at":
    configure_permission: ".*"
    read_permission: ".*"
    write_permission: ".*"
profile::archive::rabbitmq::exchanges:
  "message@/test_cc":
    ensure: "present"
    type: "direct"
    durable: true
    user: "%{lookup('profile::archive::rabbitmq::queue_user')}"  # secret
    password: "%{lookup('profile::archive::rabbitmq::queue_password')}"  # secret
  "message@/test_at":
    ensure: "present"
    type: "direct"
    durable: true
    user: "%{lookup('profile::archive::rabbitmq::queue_user')}"  # secret
    password: "%{lookup('profile::archive::rabbitmq::queue_password')}"  # secret
profile::archive::rabbitmq::arc_queues:
  "/test_cc":
    - "f98_consume"
    - "f99_consume"
    - "cc_foreman_ack_publish"
    - "cc_publish_to_oods"
    - "oods_publish_to_cc"
    - "archive_ctrl_publish"
    - "archive_ctrl_consume"
    - "telemetry_queue"
  "/test_at":
    - "f98_consume"
    - "f99_consume"
    - "at_foreman_ack_publish"
    - "at_publish_to_oods"
    - "oods_publish_to_at"
    - "archive_ctrl_publish"
    - "archive_ctrl_consume"
    - "telemetry_queue"

profile::core::systemd::tmpfile:
  docker_tmp.conf:  # XXX short term kludge
    content: "x /tmp/docker_tmp 0777 saluser saluser -"
