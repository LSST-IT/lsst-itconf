# XXX note that when provisioning a forwarder node from scratch, the puppet run
# will fail as if a profile::archive::forwarder::keytab_base64 (secret) isn't
# defined.  It isn't possible to generate the keytab until the node is
# registered with ipa -- a catch 22.  One possible work around is to
# provision the node with another role, such as `generic`, then manually create
# the keytab and switch the role.  Another would be to use a dummy (base64
# decodable) string.
---
classes:
  - "profile::archive::forwarder"
  - "profile::ccs::daq_interface"
  - "profile::core::common"
  - "profile::core::debugutils"
  - "profile::core::docker"
  - "profile::core::docker::prune"
  - "profile::core::sysctl::lhn"
  - "python"

# install docker-compose at system level
python::version: "python36"
python::pip: "present"
python::dev: "present"
python::venv: "present"
# docker-compose is python3 only
python::python_pips:
  "docker-compose":
    virtualenv: "system"
    ensure: "1.25.0"
  "cryptography":
    virtualenv: "system"
    ensure: "3.3"
files:
  "/var/log/iip":
    ensure: "directory"
    mode: "0755"
    owner: "iip"
    group: "iip"
  "/var/tmp/data":
    ensure: "directory"
    mode: "0755"
    owner: "iip"
    group: "iip"
packages:
  - "git"
