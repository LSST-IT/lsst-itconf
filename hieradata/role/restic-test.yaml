---
classes:
  - "profile::core::common"
  - "restic"

restic::bucket: "rubin-bm-backups/%{facts.fqdn}"
restic::enable_backup: true
restic::host: "s3.us-east-1.amazonaws.com"

# runs everyday at 9:00
# keeps last 20 backups
profile::core::restic::repositories:
  awsrepo:
    backup_path:
      - "/tmp/back1"
      - "/tmp/back2"
    backup_timer: "*-*-* 09:00:00"
    enable_forget: true
    forget_timer: "Mon..Sun 23:00:00"
    forget_flags: "--keep-last 20"
    password: "%{::restic_password}"
