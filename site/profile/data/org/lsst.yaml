---
profile::core::debugutils::packages:
  - "ack"
  - "bridge-utils"
  - "dhcping"
  - "iftop"
  - "iperf"
  - "iperf3"
  - "lsof"
  - "mtr"
  - "net-tools"
  - "nmap"
  - "nmap-ncat"
  - "numactl"
  - "nvme-cli"
  - "pciutils"
  - "powertop"
  - "socat"
  - "tcpdump"
  - "traceroute"
  - "tree"
  - "tuned-utils-systemtap"
  - "usbutils"
profile::ccs::postfix::packages:
  # required for postfix sasl auth
  - "cyrus-sasl-plain"

profile::ts::nexusctio::repos:
  "nexus-ctio":
    ensure: "present"
    descr: "CTIO Nexus Repository"
    enabled: true
    baseurl: "http://cagvm3.ctio.noao.edu/nexus/repository/labview-rpm/rubin/"
    gpgcheck: false
    target: "/etc/yum.repos.d/nexus-ctio.repo"
  "gpgrubin":
    ensure: "present"
    descr: "Nexus GPG Rubin Repository"
    enabled: true
    baseurl: "http://cagvm3.ctio.noao.edu/nexus/repository/gpg-rpm/rubin/"
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-MSO"
    target: "/etc/yum.repos.d/gpgrubin.repo"
  "gpgmso":
    ensure: "present"
    descr: "Nexus GPG MSO Repository"
    enabled: true
    baseurl: "http://cagvm3.ctio.noao.edu/nexus/repository/gpg-rpm/MSO/"
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-MSO"
    target: "/etc/yum.repos.d/gpgmsoo.repo"

profile::core::yum::centos::repos:
  centos-base:
    descr: "CentOS-$releasever - Base"
    enabled: true
    ensure: "present"
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7"
    mirrorlist: "http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra"
    target: "/etc/yum.repos.d/CentOS-Base.repo"
  centos-updates:
    descr: "CentOS-$releasever - Updates"
    enabled: true
    ensure: "present"
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7"
    mirrorlist: "http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra"
    target: "/etc/yum.repos.d/CentOS-Base.repo"
  centos-extras:
    descr: "CentOS-$releasever - Extras"
    enabled: true
    ensure: "present"
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7"
    mirrorlist: "http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra"
    target: "/etc/yum.repos.d/CentOS-Base.repo"
  centos-base-debuginfo:
    baseurl: "http://debuginfo.centos.org/7/$basearch/"
    descr: "CentOS-7 - Debuginfo"
    enabled: false
    gpgcheck: true
    gpgkey: "file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-Debug-7"
    target: "/etc/yum.repos.d/CentOS-Debuginfo.repo"

profile::core::yum::dell::repo:
  ensure: "present"
  descr: "Dell"
  enabled: true
  baseurl: "https://repo-nexus.lsst.org/nexus/repository/dell/"
  gpgcheck: false
  target: "/etc/yum.repos.d/dell.repo"

profile::nfs::client::csc::mounts:
  /net/project:
    share: "project"
    server: "nfs1.cp.lsst.org"
    atboot: true
  /net/scratch:
    share: "scratch"
    server: "nfs1.cp.lsst.org"
    atboot: true
  /net/home:
    share: "home"
    server: "nfs1.cp.lsst.org"
    atboot: true
  /net/lsstdata:
    share: "lsstdata"
    server: "nfs1.cp.lsst.org"
    atboot: true
  /net/auxtel/lsstdata:
    share: "lsstdata"
    server: "atarchiver.cp.lsst.org"
    atboot: true
  /mnt/data:
    share: "data"
    server: "atsdaq1.cp.lsst.org"
    atboot: true

profile::core::yum::lsst_ts::repos:
  lsst-ts:
    baseurl: "https://repo-nexus.lsst.org/nexus/repository/ts_yum/releases"
    descr: "LSST Telescope and Site Packages"
    enabled: true
    ensure: "present"
    gpgcheck: false
    target: "/etc/yum.repos.d/lsst-ts.repo"

profile::core::yum::lsst_ts_private::repos:
  lsst-ts-private:
    baseurl: "https://repo-nexus.lsst.org/nexus/repository/ts_yum_private"
    descr: "LSST Telescope and Site Private Packages"
    enabled: true
    ensure: "present"
    gpgcheck: false
    target: "/etc/yum.repos.d/lsst-ts-private.repo"

profile::core::docker::version: "19.03.15"
profile::core::docker::versionlock:
  - "1:docker-ce-cli-19.03.15-3.el7.x86_64"
  - "3:docker-ce-19.03.15-3.el7.x86_64"

profile::core::sysctl::lhn::sysctls:
  # lhn tuning
  # See https://fasterdata.es.net/host-tuning/linux/
  net.core.rmem_max:
    value: 536870912
    target: &tcpip "/etc/sysctl.d/93-tcp_ip.conf"
  net.core.wmem_max:
    value: 536870912
    target: *tcpip
  net.ipv4.tcp_rmem:
    value: "4096 87380 536870912"
    target: *tcpip
  net.ipv4.tcp_wmem:
    value: "4096 65536 536870912"
    target: *tcpip
  net.ipv4.tcp_congestion_control:
    value: "htcp"
    target: *tcpip
  net.ipv4.tcp_mtu_probing:
    value: 1
    target: *tcpip
  net.core.default_qdisc:
    value: "fq"
    target: *tcpip
